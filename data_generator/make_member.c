#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <string.h>
#include <time.h>

#include "rand_tools.h"

#include "demo_limits.h"

static char *f_name_m[] = {
"Aaron",
"Abel",
"Abraham",
"Abram",
"Adam",
"Adelbert",
"Adolf",
"Adolph",
"Adolphus",
"Adrian",
"Alan",
"Alastair",
"Albert",
"Alex",
"Alexander",
"Alexis",
"Alf",
"Alfie",
"Alfonse",
"Alfred",
"Algernon",
"Allan",
"Allen",
"Alphonse",
"Alvin",
"Ambrose",
"Andrew",
"Andy",
"Anthony",
"Anton",
"Archibald",
"Ariel",
"Arman",
"Armand",
"Armin",
"Arnold",
"Arthur",
"Ashley",
"Ashton",
"Aubrey",
"August",
"Augustus",
"Aylmer",
"Bacchus",
"Baldwin",
"Barnaby",
"Barnard",
"Barry",
"Bartholomew",
"Bartlemy",
"Basil",
"Ben",
"Benedict",
"Benjamin",
"Bennet",
"Bernard",
"Bernhard",
"Bert",
"Bertrand",
"Bill",
"Billy",
"Bob",
"Bobby",
"Brad",
"Bradley",
"Brandon",
"Brendan",
"Brent",
"Brett",
"Brian",
"Brown",
"Bruce",
"Bruno",
"Bryan",
"Byron",
"Caesar",
"Calvin",
"Cameron",
"Carey",
"Carl",
"Carol",
"Casey",
"Cecil",
"Cedric",
"Chad",
"Charles",
"Charlie",
"Chester",
"Chris",
"Christian",
"Christopher",
"Clarence",
"Clark",
"Clifford",
"Clive",
"Clyde",
"Cody",
"Colin",
"Conan",
"Conrad",
NULL /* Stopper */
};

char *f_name_f[] = {
"Cordelia",
"Corinna",
"Courtney",
"Crystal",
"Cyndy",
"Cynthia",
"Daisy",
"Dana",
"Danielle",
"Daphne",
"Darcey",
"Darla",
"Darleen",
"Darlene",
"Deanna",
"Debbie",
"Deborah",
"Delia",
"Denise",
"Diana",
"Diane",
"Dianne",
"Dolly",
"Donna",
"Doreen",
"Doris",
"Dorothy",
"Dulcie",
"Eden",
"Edith",
"Edythe",
"Eileen",
"Elaine",
"Eleanor",
"Eleanora",
"Elinor",
"Eliza",
"Elizabeth",
"Ella",
"Ellen",
"Ellie",
"Eloise",
"Elsie",
"Elvira",
"Emilia",
"Emily",
"Emma",
"Emmeline",
"Emmy",
"Enid",
"Enola",
"Erica",
"Erin",
"Esther",
"Ethel",
"Eugenie",
"Eunice",
"Euphemia",
"Eva",
"Evangeline",
"Eve",
"Evelyn",
"Evie",
"Fannie",
"Felice",
"Felicia",
"Fiona",
"Flora",
"Florence",
"Frances",
"Gail",
"Gemma",
"Georgia",
"Georgiana",
"Georgina",
"Geraldine",
"Gertrude",
"Gillian",
"Ginger",
"Gladys",
"Glenda",
"Gloria",
"Gloriana",
"Grace",
"Greta",
"Gwyneth",
"Hanna",
"Hannah",
"Harriet",
"Hazel",
"Heather",
"Helen",
"Heloise",
"Henrietta",
"Hermione",
"Hester",
"Hilary",
"Hilda",
"Hillary",
NULL /* Stopper */
};

static char *l_name[] = {
"Langford",
"Langridge",
"Langshaw",
"Langton",
"Lannaman",
"Lansbury",
"Lansdowne",
"Lappin",
"Larner",
"Lascelles",
"Latimer",
"Laughton",
"Laurenson",
"Law",
"Lawes",
"Lawrence",
"Lawson",
"Layard",
"Leach",
"Leacock",
"Leahy",
"Leakey",
"Lean",
"Lear",
"Leary",
"Leavis",
"Lecky",
"Lee",
"Leek",
"Legge",
"Leigh",
"Leith",
"Leland",
"Lemmon",
"Lennon",
"Lerwill",
"Leslie",
"Lessing",
"Lester",
"Levin",
"Levine",
"Levins",
"Lewis",
"Leyland",
"Leyton",
"Lick",
"Liddell",
"Lightfoot",
"Lilburne",
"Lilienthal",
"Lillie",
"Lily",
"Lilye",
"Linacre",
"Lindbergh",
"Lindgren",
"Lindley",
"Lindsay",
"Lindsey",
"Linehan",
"Linton",
"Lippincott",
"Lipscomb",
"Lipset",
"Lipson",
"Lipton",
"Lister",
"Littler",
"Littleton",
"Livermore",
"Livingston",
"Livingstone",
"Llewellyn",
"Lloyd",
"Lockhart",
"Logan",
"London",
"Lonergan",
"Long",
"Longfellow",
"Longhurst",
"Lonsdale",
"Lord",
"Lott",
"Love",
"Lovecraft",
"Lowe",
"Lowell",
"Lucas",
"Luce",
"Lucraft",
"Lugard",
"Lumley",
"Lydgate",
"Lyly",
"Lynch",
"Lynd",
"Lynton",
"Lyons",
"Lythgoe",
"Pester",
"Peters",
"Peyton",
"Phelan",
"Philips",
"Phillips",
"Phillipson",
"Phillpotts",
"Philpot",
"Phoenix",
"Pickering",
"Pickles",
"Pierce",
"Pilcher",
"Pilkington",
"Pincott",
"Pinter",
"Pirie",
"Pitman",
"Pitt",
"Pitts",
"Plant",
"Pointer",
"Pollock",
"Ponting",
"Poole",
"Porter",
"Postlethwaite",
"Poswell",
"Potter",
"Pottinger",
"Potts",
"Powell",
"Power",
"Preece",
"Prescott",
"Press",
"Preston",
"Price",
"Prichard",
"Pridgen",
"Priestley",
"Prime",
"Primrose",
"Probert",
"Prosser",
"Proudfoot",
"Prowse",
"Pryce",
"Pugh",
"Purcell",
"Pyle",
"Quaife",
"Quigley",
"Quilter",
"Quin",
"Quine",
"Quinn",
"Quirk",
"Rabkin",
"Rackham",
"Radcliffe",
"Radford",
"Rae",
"Rafferty",
"Raikes",
"Raine",
"Rainwater",
"Raleigh",
"Rampling",
"Ramsay",
"Ramsey",
"Rance",
"Rand",
"Randall",
"Rangeley",
"Rankin",
"Ransome",
"Rapp",
"Raskin",
"Ratcliffe",
"Rathbone",
"Ravenscroft",
"Rawsthorne",
"Ray",
"Raymond",
"Raynor",
"Read",
"Reade",
"Reber",
"Recorde",
"Reddie",
"Reddington",
"Redfield",
"Redford",
"Redgrave",
"Redmayne",
"Redmond",
"Redrup",
"Reece",
NULL /* Stopper */
};

static inline time_t get_birthday(time_t now) {
  time_t result = (time_t)0;

  /* Get time between 10 years and 43 years before */
  result = now - (lrand() % (33 * 365 * 24 * 60 * 60));
  result -= 10 * 365 * 24 * 60 * 60;

  return result;
}

int main(int argc, char *argv[]) {
  int iter = 0;
  int l_name_count = 0, f_name_count[2] = { 0, 0 };
  uint32_t count = 0;
  char *temp = NULL;

  time_t now = (time_t)0, birthday = (time_t)0;
  struct tm *ts = NULL;
  char buf[100] = { '\0' };

  int check[CITY_MAX + 1] = { 0 };

  l_name_count = sizeof(l_name) / sizeof(char *) -1; /* Decrease for NULL */
  f_name_count[0] = sizeof(f_name_m) / sizeof(char *) -1; /* Decrease for NULL */
  f_name_count[1] = sizeof(f_name_f) / sizeof(char *) -1; /* Decrease for NULL */

  (void) time(&now);
  INIT_SRAND();

  for(iter = 0; iter < CUSTOMER_MAX; iter++) {
    int city = 0;
    int gender = 0;

    do {
      city = (int)(round(abs(rand_exp((double)1.0) * 10.0))) + 1;
    } while (city > CITY_MAX);

    memset(buf, '\0', sizeof(buf));
    birthday = get_birthday(now);
    ts = localtime(&birthday);
    strftime(buf, sizeof(buf), "%Y-%m-%d %H:%M:%S", ts);

    gender = lrand() % 2;
    if (gender) {
      /* Male */
      printf("%d\t%s\t%s\t%d\t%s\tM\n",
        iter + 1, l_name[lrand() % l_name_count],
        f_name_m[lrand() % f_name_count[0]], city, buf);
    } else {
      /* Female */
      printf("%d\t%s\t%s\t%d\t%s\tF\n",
        iter + 1, l_name[lrand() % l_name_count],
        f_name_f[lrand() % f_name_count[1]], city, buf);
    }

    check[city]++;
  }

  for(iter = 0; iter <= CITY_MAX; iter++) {
    fprintf(stderr, "Check count [%d] : %d\n", iter, check[iter]);
  }

  return 0;
}
